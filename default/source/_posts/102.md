---
title: 【转&存の教程】【小白单库外网详细教程】原创by七彩印象
tags:
  - DNF
  - 服务端
  - 架设
  - 游戏
url: NaN.html
id: .nan
categories:
  - 计算机
date: 2017-08-13 21:17:00
---

*   *   *   *   *   -

近期很多人問我單庫外网的问题，甚至还有人搞外网搞了一个多月没成功的，外网真的很简单，废话不多说，下面接教程

首先确保你先安装好了WINSCP跟Navicat11：

N11是修改数据库用的，有些服务端限制了IP的登入，设置好了会显示网络连接中断之类的，这一块儿就是关键；

winscp主要用于替换PVF跟密钥，还有修改外网数据用的

**重中之重：**

由于服务端的IP是192.168.200.131，意思就是说服务端处于200网段下，在做准备工作之前，你需要把你路由器IP改为192.168.200.1，

这样做是为了跟虚拟机中保持同一网段，默认是192.168.1.1或者是192.168.0.1

1.首先解压缩好服务端，打开虚拟机，在抬头出点编辑-虚拟网络编辑器-VMware0改成桥接到你的物理网卡（默认是自动的）

2.禁用VMware1跟8，win7系统在右下角网络图标那一块儿-右键-打开网络共享中心-更改适配器设置-禁用这两个虚拟网卡

3.打开你解压好的单库服务端（猴子端神龙端都是一样的），然后配置一下服务端设置：网络适配器-由原先的NET连接改为网卡物理桥接

桥接模 式B，不用勾选复制到物理网咯状态，这里给小白科普一下，为什么要桥接到物理网卡呢？

因为NET连接方式，与主机网络不发生任何数据传输， 仅可以在虚拟机内部构建网络，而物理桥接是直接与主机网络相通的，外网是必须这么设置的。

4.更改硬盘配置：SCSI-高级-模式-勾选永久保存

5.打开虚拟机，等待虚拟机前面的数据加载完后，在虚拟机中输入root，密码123456（输入密码的时候是看不到的，并不是没有输入上），做完以上操作后，不用就切换回你的主机里，不要再做任何虚拟机的操作

6.用winscp连接服务端：

主机名中输入：192.168.200.131，端口号不用管他，用户名root，密码123456

连接成功后找到目录 `ETC/Sysconfig/network`将下面一段话复制进去（注意：gateway是你的路由器的IP，上面已经说过了改到了200网段）

    NETWORKING=yes
    NETWORKING_IPV6=no
    HOSTNAME=http://www.abc.com
    GATEWAY=192.168.200.1

直接把原来的东西删掉直接吧上面的东西放进去就行然后点左上角的保存按钮。

7.在目录`ETC/Sysconfig`下，找到 `network-scripts` 这个文件夹打开 `ifcfg-eth0`，将下面一段话复制进去，跟上面操作一样

    # Advanced Micro Devices [AMD] 79c970 [PCnet32 LANCE]
    DEVICE=eth0
    BOOTPROTO=static
    BROADCAST=192.168.200.255
    IPADDR=192.168.200.131
    NETMASK=255.255.255.0
    NETWORK=192.168.200.0
    GATEWAY=192.168.200.1
    ONBOOT=yes
    USERCTL=yes

然后点击保存（做完此步骤，一直切换到服务端根目录然后接着做以下操作

8.在目录`Home/DXF`目录下（神龙端DXF目录叫做Neople）打开 `Channel` 文件夹下的CFG文件夹然后接着打开 `Channel.cfg`文件， **this_ip = 改为你的外网IP**，其余不变。

9.`Home/DXF/Game`目录下打开`CFG`文件夹，**cain01，cain02，cain03**做以下修改：

    ip = 外网IP
    udp_ip_of_hades = 外网IP
    ipg_ip = 同上
    nxj_ipg_ip = 同上
    relay_ip = 同上
    stun_ip= 同上
    stun_ip= 同上
    stun_ip= 同上

以下IP改为你的外网IP，（外网IP在百度上输入IP，显示出来就是你的外网IP）

在目录`Home/DXF`下，找到`relay`文件夹打开`CFG`文件夹找到**relay 200.cfg**这个文件打开：**this_ip = 外网ip**（灰常重要）

修改完点击保存，3个文件都要修改（cain01是1频道，cain02是11频道，cain03是52频道（PK频道））

10.以上操作架设外网第一阶段就告一段落了。如何使刚才设置的生效呢？

切换回虚拟机里：输入一行命令：

`service network restart`操作过后你会看到4个`OK`，说明以上配置的没有问题，而且都生效了。至此基础架设工作完毕。

11.**端口映射**

以下端口都要映射，才能保证保证组队PKC都是正常的：

7000 7001 80（注意：这个端口的作用是让你的主机可以暴漏在 广域网当中，也就是外网很重要的一个端口，IP填写你本地IP）

9006 7200 （2311 2312 2312 这三个端口的作用就是组队的端口， 很多组不了队的都是死在了这里）

10011

11011

10001

11001

10031

11031

{再啰嗦一句：如果你想让你的朋友在他的电脑上 也可以使用GM 工具，3306端口 也是要映射的}

以上端口全部开放，IP统一为192.168.200.131，协议统一ALL

有些小白如果单另映 射UPD跟tcp的话会出错的，这里就直接改成all即可，对游戏没有任何影响

（为什么有些人进不了PKC呢，因为 没有映射10031跟 11031这两个端口，这两个端口就是组队映射的重要端口）

DMZ主机为192.168.200.131，如果你的朋友连接不到你的主机改为你的本地 IP

12**配置登录器：**

我个人建议，对于小白来说，就不要用那种需要上传列表的登录器了，因为他们都不知道列表是什么，更不知道那个地址 哪里来，配置的登录器显示的服务器状态都是关闭的，这个会困扰小白的，

如果执意想用网关登录器，我给你个列表上传的空间，该空 间列表能保存7天，7天后需要重新上传列表，地址如下

`http://l.gmbbk.com/?FLAG`

至于网关登录器，贴吧QQ群里一大堆，自行去找吧

如果就是简单的跟朋友一起玩，不对外公布外网地址的话，我觉得有个懒人登录器V3.1就足够了，单机外网通杀，很好用的一款登录器 （虽然外观长的不咋地）

解压缩懒人登录器，把密钥publickey.pem上传到服务端Home/DXF/Game目录下覆盖原有密钥。

注意：每一个登 录器都有一个配套的密钥，如果密钥不符会造成无限连接频道的问题。

13.**更改HOST：**

在你C盘`windows/system32/drivers/etc`目录下，用记事本打开**HOST文件**添加一行：

（你的外网IP） start dnf tw

**注意**，千万**不要**跟上面一样前面添加#符号，直接加上一行就行

14.有些单库的端，即使前面配置好了以后，还是会出现无线连接频道或者是接收频道数据失败，主要原因是在geo allw里面，出现这几种情况，也有可能是这个的问题，因为客户端没有解除对IP的限制，你需要手动添加进去你的IP，这时候，你需要打开Navicat mysql这个软件（自行下载）

连接名所以写-主机IP地址：

192.168.200.131-端口3306-账号game 密码uu5!^%jg连接，

连接成功后找 “d_taiwan”双击然后找到geo allow打开，填写以下IP

    192.168.200.0
    192.168.200.1（路由器地址）
    XXX.XXX.XXX.X（外网IP）
    XXX.XXX.XXX.X（你朋友的外网IP）
    192.168.200.*（不解释）
    192.168.200.X（如果你开的是局域网需要添加局域网IP允许）

改完后点击保存，至此，所有外网架设完毕

特别声明：最近问我的小白挺多的，我想说人人都是从小白过来的，少问，多看，不要一进群就问这个问那个，谁也会烦的，先看看群文件里有没有你需要的东西，或者经常看的点论坛贴吧，教程帖子一大堆，

自己多看看会学到很多东西，先动手，再动嘴。

最后附上所有需要做的端口映射截图，按照上面的操作，一步一步的来，保证你外网成功。

PS：登录器的IP填写为你的外网IP然后直接点连接就行，因为数据库已经移到了你的本机，所以需要填写你的外网IP，注册账号，开始游戏

--------------------------------------------------------------------------------------by 七彩印象

贴吧ID：d66615486

如果你本机能进游戏，你朋友却卡在频道中，让你的朋友检查他主机上的HOST是否是你的外网IP

*   *   *   *   *   -

均为转载，侵删